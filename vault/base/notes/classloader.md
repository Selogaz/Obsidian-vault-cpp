---
aliases: []
created: 2025-05-21 10:37:22+03:00
deck: obsidian::work
sr-due: 2025-06-18
sr-ease: 210
sr-interval: 15
tags:
- note/specific/code
- category/java
updated: 2025-06-03 07:09:08+03:00
---

**Classloader**
—
# Общие понятия загрузчика

Загрузчик классов является частью [[JRE]], которая динамически загружает Java классы в JVM. Обычно классы загружаются только *по запросу*. Система исполнения *не должна знать* о файлах и файловых системах благодаря загрузчику классов.[^1] Загрузчик классов *делегирует работу с файлами* и файловой системой[^2]
Загрузчик классов отвечает за:
- *поиск* библиотек
- *чтение* их содержимого
- *загрузку классов*, содержащихся в библиотеках
	- загрузка *не происходит до тех пор, пока программа не вызовет класс*
	- Класс с именем может быть загружен одним загрузчиком только *один раз*

При запуске JVM, используется 3 загрузчика классов:
- Bootstrap class loader
	- Bootstrap загружает *основные библиотеки*, расположенные в папке `<JAVA_HOME>/jre/lib`. Является *частью ядра* JVM, написан на нативном коде.[^3]
- Extensions class loader
	- Загружает код в *каталоги расширений*[^4]
- System class loader
	- загружает код, найденный в `java.class.path`, который сопоставляется с [[переменные среды|переменной среды]] [[classpath|`CLASSPATH`]][^5]

Загрузчик классов выполняет *три основных действия в строгом порядке*:
- ***Загрузка***: находит и импортирует двоичные данные для типа
- ***Связывание***: выполняет проверку, подготовку и (необязательно) разрешение
	- ***проверка***: обеспечивает *правильность* импортируемого типа
	- ***подготовка***: *выделяет память* для переменных класса и *инициализирует память* значениями по умолчанию
	- ***разрешение***: *преобразует* [[символическая ссылка в java|символические ссылки]] из типа *в прямые ссылки*
- ***Инициализация***: вызывает код Java, который инициализирует *переменные класса* их правильными начальными значениями

- [x] #task/inbox #category/work Что такое JRE ✅ 2025-05-23
- [x] #task/inbox #category/work что такое символические ссылки ✅ 2025-05-23
- [x] #task/inbox #category/work что такое переменные среды ✅ 2025-05-23

# Пользовательский загрузчик классов

Существует возможность создания *своего загрузчика* классов, ведь он написан на Java. У каждого загрузчика есть *родительский загрузчик* классов. Он может определяться *при создании нового экземпляра* загрузчика или *в* *качестве системного загрузчика* по умолчанию для виртуальной машины

Возможности пользовательского загрузчика:
- *загружать или выгружать* классы во время выполнения[^6]Это важная особенность для:
	- реализации скриптовых языков
	- использования [[bean builder|bean builders]]
	- добавления пользовательского расширения
	- позволения общения нескольким пространствам имен. Например, это одна из основ протокола [[CORBA и RMI|CORBA / RMI]]
- *изменить способ загрузки* байт-кода[^7]
- *модифицировать* *загруженный* байт-код[^8]

- [x] #task/inbox #category/work bean builders ✅ 2025-05-23
- [x] #task/inbox #category/work CORBA / RMI ✅ 2025-05-23
- [x] #task/inbox #category/work аспектно-ориентированное программирование ✅ 2025-05-23

[^1]: чтобы сохранить свою независимость, модульность и безопасность, а также обеспечить платформенную независимость Java.
[^2]: (кому?)
[^3]: Bootstrap Class Loader написан на нативном коде(С/С++), потому что он загружает базовые классы Java до инициализации JVM, работает напрямую с операционной системой и обеспечивает высокую производительность.
[^4]: `<JAVA_HOME>/jre/lib/ext`, или любой другой каталог, указанный системным свойством `java.ext.dirs`).
[^5]: реализуется классом `sun.misc.Launcher$AppClassLoader`
[^6]: например, динамически загружать библиотеки во время выполнения, даже из ресурса HTTP
[^7]: например, использовать зашифрованный байт-код класса Java
[^8]: например, для переплетения аспектов во время загрузки при использовании [[AOP|аспектно-ориентированного программирования]]